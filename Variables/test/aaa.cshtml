@inherits avt.MyTokens.Core.ParsingEngine.RazorTemplate
@using DnnSharp.Common2.IoC
@{
    DnnSharp.Common.Debugger.Launch();
    var x = "AppContainer_root_PAAC";
    var resolver = GlobalContainer.RootProvider.Resolve<IServiceResolver, string>(x);
    var dbService = resolver.Resolve<DnnSharp.Common2.Services.Db.IDbService>();
    var repoType = Type.GetType("PlantAnApp.ActionEngine.Services.Repositories.IActionParameterRepository,PlantAnApp.ActionEngine");
    var paraRepo = resolver.Resolve(repoType);

    var getAllMethod = paraRepo.GetType().GetMethod("GetAll");
    var actionParameters = getAllMethod.Invoke(paraRepo, new object[] { }) as List<PlantAnApp.ActionEngine.Models.ActionParameter>;

    actionParameters.Where(p => p.Id < 4133).Select(p => {
        dbService.InsertWithIdentity(p);
        return true;
    }).ToList();
}

